{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Chromium: LLDB (CodeLLDB)",
      "type": "lldb",
      "request": "launch",
      "program": "${workspaceFolder}/${config:chromium.buildDir}/${config:chromium.runtimeExecutable}",
      "osx": {
        "program": "${workspaceFolder}/${config:chromium.buildDir}/${config:chromium.runtimeExecutableMac}",
        "args": [
          "--remote-debugging-port=9222",
          "--user-data-dir=${config:chromium.userDataDir}",
          "--no-first-run",
          "--no-sandbox",
          "--password-store=basic",
          "--use-mock-keychain"
        ]
      },
      "linux": {
        "program": "${workspaceFolder}/${config:chromium.buildDir}/${config:chromium.runtimeExecutableLinux}"
      },
      "args": [
        "--remote-debugging-port=9222",
        "--user-data-dir=${config:chromium.userDataDir}",
        "--no-first-run",
        "--no-sandbox",
        "--password-store=basic"
      ],
      "cwd": "${workspaceFolder}/${config:chromium.buildDir}",
      "env": {
        // This needs to be set manually before running, since the script can set it after the fact
        "CHROMIUM_LLDBINIT_SOURCED": "1"
      },
      "preLaunchTask": "chromium: build and prep",
      "stopOnEntry": false,
      "initCommands": [
        "script sys.path[:0] = ['${workspaceFolder}/tools/lldb']",
        "script import lldbinit",
        "script import chromium_visualizers"
      ]
    },
    {
      "name": "Chromium: Attach (CodeLLDB)",
      "type": "lldb",
      "request": "attach",
      "pid": "${command:pickProcess}",
      "stopOnEntry": false,
      "initCommands": [
        "script sys.path[:0] = ['${workspaceFolder}/tools/lldb']",
        "script import lldbinit",
        "script import chromium_visualizers"
      ]
    },
    {
      "name": "Chromium: Attach renderer by URL (CodeLLDB)",
      "type": "lldb",
      "request": "attach",
      "pid": "${input:chromiumRendererPid}",
      "preLaunchTask": "chromium: launch renderer for native attach",
      "stopOnEntry": false,
      "initCommands": [
        "script sys.path[:0] = ['${workspaceFolder}/tools/lldb']",
        "script import lldbinit",
        "script import chromium_visualizers"
      ],
      "postRunCommands": [
        "process signal SIGUSR1"
      ]
    }
  ],
  // Requires the Command Variable extension for reading the renderer PID file.
  "inputs": [
    {
      "id": "chromiumRendererPid",
      "type": "command",
      "command": "extension.commandvariable.file.content",
      "args": {
        "fileName": "${config:chromium.rendererPidFile}",
        "trim": true
      }
    }
  ]
}
